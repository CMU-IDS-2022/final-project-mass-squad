# Final Project Report

**Project URL**: https://share.streamlit.io/cmu-ids-2022/final-project-mass-squad/sidharth
**Video URL**: TODO

Short (~250 words) abstract of the concrete data science problem and how the solutions addresses the problem.

## Introduction

The Yelp dataset contains rich information about businesses ranging from their attributes and photos to ratings and reviews provided by their clients. This data provides a window into understanding how a business is performing over time both when looked at independently and when compared to other similar businesses. 

The goal of this project is to utilize signals from textual reviews and star ratings provided by clients of businesses represented in the dataset to understand what features make a good business, how a business compares to other similar businesses in the area, and how a business is perceived by its clients. To narrow down the scope of our work, we limit the businesses studied to those that are restaurants only. 

We break down our analyses into three prongs, each of which has a unique motivation and end-user -
- The first piece of the puzzle is to provide users of the application with visualizations that reveal the specific attributes of a business that correlate to better and worse ratings. This will allow both existing business owners and aspiring business owners to identify performance-boosting attributes and implement them in their own businesses.
- The second piece provides a business owner with a view into their own business. This view allows owners to study textual reviews to understand what clients are writing about their business. It also shows them a clear picture of the distribution of their most recent reviews and how their reviews have changed over time to enable them to understand how changes they make along the way affect their business.
- The final prong enables owners, aspiring owners, or just regular people looking for a place to eat to study businesses in their area. We utilize measures of similarity to identify similar businesses and present information about their reviews, attributes they have that your business does not, and also a comparative study of their review against yours over time.


## Related Work

The Yelp dataset is a very popular dataset and its rich content can motivate numerous directions of exploration.  There are several open-source projects exploring this dataset in their own unique ways starting with [1] which was a machine learning-heavy project that correlated the trends between consensus data and the yelp business information. While the project delves into several visualizations to highlight their point, being machine learning-oriented the focus is more tilted towards finding meaningful correlations between the above said datasets. Our app does share visualizations such as average star rating over time and word cloud with this project, yet we focused heavily on the interactive aspect of the dataset. For instance, rather than simply rendering a word cloud on review text as done in this project, we present a dynamic word cloud based on sentiment analysis thereby giving the user more control over which aspects of the reviews they wish to explore. Another popular project is [2], which tries to explore the dataset on several criteria for each location. This involves review count and star ratings by neighborhood and attributes popular in every neighborhood. In this sense, the project is quite narrowed down as opposed to our app which allows for both a location-specific exploration using relevant filters and a more general analysis of location-agnostic trends. [3] is an example of one of many projects that take the opposite route to ours and focus on the user side. While we allow restaurant owners to analyze their business and compare it with competitors, this project delves deep into how a user can find their next favorite restaurant. While the idea of the project differs, the metrics of focus remain the same i.e. popular attributes, location, and reviews.

## Methods

Our application utilizes a number of visualization techniques and algorithms to manipulate and present data in an accessible way to the end-users. 

### Data Preprocessing - Businesses
The business data pertained to several categories such as restaurants, castles, shopping etc. and on analyzing the categories' value count, we found restaurants were the most populous. Thus, to limit the scope of our analyses and build a focussed application, we centered our study around businesses that are restaurants only. To do this, we first eliminated all businesses where the attribute that contained information about the type of business was missing. Then we identified and retained only those businesses whose type was restaurant. 

Given the pruned set of businesses, the next task was to study the attributes of each restaurant. We decided to only retain categorical boolean attributes. This decision was motivated by the requirement to compute similarity scores between pairs of businesses for a component of our application. We then looked for missing values as well as the count of each unique value of each attribute across all restaurants. We dropped attributes where a large proportion of the values were missing, and also dropped attributes where a large majority of restaurants shared the same value for that attribute as such attributes do not convey any information about differences between businesses. 

Given the limited set of businesses as well as attributes, the final task was to handle missing values. For the retained boolean attributes, we made the assumption that a missing value indicates that the business does not exhibit this attribute. This left our final business dataset with business ids, name, relevant information about location and star ratings. 

### Data Preprocessing - Reviews
The raw reviews file consisted of around 5 million reviews and was too big for Streamlit to handle. To preprocess the reviews dataset, we begin by first dropping all restaurants that do not exist in the pruned business dataset. This is done to ensure consistency between both datasets and made the reviews data a lot more manageable yielding an efficient final app. Several fields of this dataset such as indicators of whether the review is “funny” or “cool” are not relevant to our analysis. We drop these attributes. This left our final review dataset with review text, star ratings, creation time and useful upvotes along with relevant business ids and names. 

### Methods - Overall Landscape
To study how each feature of a business correlates with ratings, we employ grouped bar charts for each feature. Grouped bar charts show the contrast between having and not having each feature in terms of the distribution of star ratings. Distributions that are skewed to the right indicate that having/not having that attribute leads to higher ratings, while distributions skewed to the left indicate that having/not having that attribute leads to lower ratings.  These plots are generated from data across all businesses. We allow users to interact with the plots by providing selectors for state, city and the specific features they’d like to study. 

### Methods - Your Restaurant
The goal of this section is to allow a restaurant owner to study their reviews and ratings. In order to better understand their reviews, we create a word cloud to show which words are most frequently used to describe customer experiences. However this may not always be useful if the words that describe a positive or negative review are not frequent across all reviews. To allow users to identify and study positive and negative reviews separately, we perform sentiment analysis on each review text to obtain a polarity score between -1 and 1. We allow the user to interact with the word cloud by changing which reviews are included based on a polarity score slider. We use VADER, a rule based sentiment analysis tool built on social media reviews, to compute the sentiment polarity scores. The default range for the slider was set to -0.5 to 0.5 as we believe such a range would allow an insightful analysis while avoiding extreme sentiments.

This section also presents a histogram to study the distribution of the star ratings distribution the selected restaurant has received in its lifetime. The bins ranged from one to five corresponding to range of star ratings and a value count of all the reviews in this bin was displayed for insights on overall performance of the performance. While overall performance is a useful metric, to make the visualization more insightful we added tooltips that show the most useful reviews to help the owner understand what factors cause users to rate the business as they did. This most useful review is selected as the one having the highest number of ‘useful’ upvotes in that particular bin.

Finally, this section also includes a line graph to track how a restaurant’s average ratings have changed over time. Average ratings were calculated for each year and plotted against the entire lifetime of the restaurant. To add further insights to this visualization, we added a tooltip indicating the most useful, most positive and most negative review. The most useful review is the one having the most ‘useful’ upvotes in a given year. Similarly, the most positive and most negative review was sampled from the set of reviews which had the highest and lowest star rating for each year.


### Methods - Similarity
The final component of our application is a section that allows users to study restaurants that are either similar to theirs, or restaurants that are selected based on filters created by the user. Selected restaurants are plotted on a map with interactive tooltips that give users information about the restaurant’s rating, attributes of the business that are not shared with your own business (allowing you to understand what may be responsible for differences in ratings between restaurants) and top reviews of the restaurant. We also create comparative line graphs that allow users to compare their business with selected restaurants over time. 

To identify similar businesses, we compute the cosine similarity between the binary attribute vectors corresponding to each business.

## Results

## Discussion

The initial and the main objective of our application was to make sure we provide the restaurant owners with interactive visualizations that they can review in order to help them get better reviews and be able to improve their service. The idea eventually transformed into something that could have a much broader impact in terms of use for not just restaurant owners but the entrepreneurs who want to enter the business as well as the foodies. The existing yelp review system provides you reviews that you have to scour through to actually figure out what's going wrong and what's going right with the restaurant. The word cloud provides a much cleaner and simpler view into depicting the overall sentiments of the customers. With the overall flow of the ratings throws the years you can then focus on what went well in that specific year which gives you a hint as to the current trends in the restaurant market. Our world is an ever-changing landscape and keeping up with the latest trends is really important thus keeping yourself updated with the yearly trends provides huge insight for the owners and the entrepreneurs. Existing visualizations of the data don't provide you with an overall landscape that is granular enough for the user to select various categories and dig into details of the specific state and city. Another new visualization we add to our application is the competitions page which introduces a similarity measure in the form of cosine similarity that helps the user to find similar restaurants and the owners the option to compare themselves with similar restaurants in terms of categories and the state of ratings. The application overall we feel was able to meet its purpose in providing visualizations that don't overload the user with details initially but provide them with options to dig around if they wish to do more analysis.

## Future Work

The current application of the system provides both granularity and options to dig into finer details. The next step we feel is to actually add more functionality in terms of categories which we had to scrap because of the time constraints and the complexity of scrapping they required. An addition down the line would be to add year-wise granularity in the overall landscape and possibly a line graph mapping to the bar graph and showcasing how ratings transition through the years for certain categories. While all these ideas pertain to focusing on finer details in the dataset, one big change can be adding complexity to backend preprocessing of the data using machine learning models. We tried to add this element through a sentiment analysis based approach, yet other visualization can also benefit from such involved machine learning tools in order to provide a competitive edge to our users. Another step is to actually push the app to the web for eventual use in public. Also, we currently use static data to create the visualizations a good next step would be to add yelp APIs to pull data every 3-4 months. Finally, to add a further layer of complexity, the yelp dataset can be combined with other relevant datasets such as consensus data to explore several dimensions that aren’t explicit through one dataset alone. This can include inherent correlations such as demographics or race distribution of a particular neighborhood leading to the popularity of certain restaurant attributes. 

## References

[1] Machine Learning and Visualizations with Yelp Dataset
[2] Yelp visualization
[3] Discover Your Next Favorite Restaurant
